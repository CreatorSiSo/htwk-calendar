---
import Layout from "../layouts/Layout.astro";

type Event = {
  name: string;
  notes: string;
  weekday: Weekday;
  weeks:
    | { Single: number }
    | { Multiple: Array<number> }
    | { Range: { start: number; end: number } };
  start: [number, number, number, number];
  end: [number, number, number, number];
};

enum Weekday {
  Monday = 1,
  Tuesday,
  Wednesday,
  Thursday,
  Friday,
  Saturday,
  Sunday,
}

const res = await fetch("http://localhost:5000/events/23INB-3");
const events: Array<Event> = await res.json();

const events_on_days: Map<Weekday, Event[]> = new Map([
  [Weekday.Monday, []],
  [Weekday.Tuesday, []],
  [Weekday.Wednesday, []],
  [Weekday.Thursday, []],
  [Weekday.Friday, []],
  [Weekday.Saturday, []],
  [Weekday.Sunday, []],
]);
for (const event of events) {
  events_on_days.get(event.weekday)?.push(event);
}
---

<Layout title="HTWK Stundenplan">
  <main class="h-full">
    <!-- <div class="flex flex-col h-80">
      <div class="flex">
        <span class="flex-1">Montag</span>
        <span class="flex-1">Dienstag</span>
        <span class="flex-1">Mittwoch</span>
        <span class="flex-1">Donnerstag</span>
        <span class="flex-1">Freitag</span>
        <span class="flex-1">Samstag</span>
        <span class="flex-1">Sonntag</span>
      </div>
      <div class="flex">
        {
          Array.from(events_on_days.entries()).map(([weekday, events]) => (
            <div class="flex-1 flex flex-col">
              {events.map((event) => (
                <span>{`${event.start[0]}:${event.start[1]} - ${event.end[0]}:${event.end[1]}`}</span>
              ))}
            </div>
          ))
        }
      </div>
    </div> -->
    <div id="calendar" class="max-h-full"></div>
  </main>

  <script>
    import "../components/Calendar.ts";
  </script>
</Layout>
